CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT( Orthoklampt )

set(ORTHOKLAMPT_MAJOR_VERSION 0)
set(ORTHOKLAMPT_MINOR_VERSION 1)
set(ORTHOKLAMPT_PATCH_VERSION 0)
set(ORTHOKLAMPT_VERSION ${ORTHOKLAMPT_MAJOR_VERSION}.${ORTHOKLAMPT_MINOR_VERSION}.${ORTHOKLAMPT_PATCH_VERSION})

SET(KLAMPT_ROOT /home/aorthey/git/Klampt/)
LIST(APPEND CMAKE_MODULE_PATH "${KLAMPT_ROOT}/CMakeModules")
LIST(APPEND CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}/CMakeModules")
INCLUDE(CMakeColors)
MESSAGE(COLOR_WHITE ${DEPENDENCIES})
set(CMAKE_CXX_COMPILER "g++-5")

###############################################################################
MESSAGE("${CMAKE_MODULE_PATH}")
###############################################################################

SET(DEPENDENCIES ${DEPENDENCIES} OMPL)
FOREACH(DEPENDENCY ${DEPENDENCIES})
  FIND_PACKAGE(${DEPENDENCY} REQUIRED)
ENDFOREACH(DEPENDENCY)

FIND_PACKAGE(Eigen3 REQUIRED)
SET(DEPENDENCIES ${DEPENDENCIES} EIGEN3)

FIND_PACKAGE(CGAL 4.10 REQUIRED)
SET(DEPENDENCIES ${DEPENDENCIES} CGAL)
INCLUDE( ${CGAL_USE_FILE} )

FIND_PACKAGE(Klampt REQUIRED)
SET(DEPENDENCIES ${DEPENDENCIES} KLAMPT)

FIND_PACKAGE(Boost 1.55.0 REQUIRED COMPONENTS filesystem thread serialization system)
SET(DEPENDENCIES ${DEPENDENCIES} Boost)

#cmake_policy(SET CMP0015 NEW)
#SET(SBL_USE_LIBS ESBTL CGAL MPFR GMP Boost)
#if ( SBL_FOUND )
#  INCLUDE(${SBL_USE_FILE}) 
#endif()
INCLUDE_DIRECTORIES("/usr/local/sbl/Core/Betti_numbers/include/")
#INCLUDE_DIRECTORIES(${SBL_DIR})
#set(SBL_INTERNAL_ARCHITECTURE OFF)
#set(SBL_FOUND TRUE)
#if(EXISTS ${SBL_DIR}/UseSBL.cmake)
# set(SBL_CMAKE_DIR "${SBL_DIR}")
#  MESSAGE("1")
# set(SBL_USE_FILE "${SBL_CMAKE_DIR}/UseSBL.cmake")
#else()
#  if(EXISTS ${SBL_DIR}/cmake/Modules/UseSBL.cmake)
#   set(SBL_CMAKE_DIR "${SBL_DIR}/cmake/Modules")
#   set(SBL_USE_FILE "${SBL_CMAKE_DIR}/UseSBL.cmake")
#  else()
#    if(EXISTS ${SBL_DIR}/share/cmake/Modules/UseSBL.cmake)
#     set(SBL_CMAKE_DIR "${SBL_DIR}/share/cmake/Modules")
#     set(SBL_USE_FILE "${SBL_CMAKE_DIR}/UseSBL.cmake")
#    endif()
#  endif()
#endif()
#FIND_PACKAGE(SBL REQUIRED)

MESSAGE(COLOR_WHITE "-------------------------------------")
MESSAGE(COLOR_WHITE "-- INCLUDING DEPENDENCIES")
MESSAGE(COLOR_WHITE "-------------------------------------")
MESSAGE(COLOR_WHITE "")

FOREACH(DEPENDENCY ${DEPENDENCIES})
  MESSAGE(COLOR_WHITE "-- ${DEPENDENCY}")
  MESSAGE("VERSION   :  ${${DEPENDENCY}_VERSION}")
  MESSAGE("LIBRARIES :  ${${DEPENDENCY}_LIBRARIES} ${${DEPENDENCY}_LIBS}")
  SET(ORTHOKLAMPT_LIBRARIES ${ORTHOKLAMPT_LIBRARIES} ${${DEPENDENCY}_LIBRARIES} ${${DEPENDENCY}_LIBS})
  MESSAGE("INCLUDE   :  ${${DEPENDENCY}_INCLUDE_DIRS} ${${DEPENDENCY}_INCLUDE_DIR}")
  INCLUDE_DIRECTORIES(${${DEPENDENCY}_INCLUDE_DIRS})
  INCLUDE_DIRECTORIES(${${DEPENDENCY}_INCLUDE_DIR})
  ADD_DEFINITIONS(${${DEPENDENCY}_DEFINITIONS})
ENDFOREACH(DEPENDENCY)

SET(ORTHOKLAMPT_LIBRARIES ${ORTHOKLAMPT_LIBRARIES} ${OMPLAPP_LIBRARIES} ompl_app_base emon)

INCLUDE_DIRECTORIES(src)
INCLUDE_DIRECTORIES(src/planner)

FILE(GLOB ORTHOKLAMPT_SRC src/*.cpp src/planner/*.cpp src/elements/*.cpp src/controller/*.cpp)

MESSAGE(COLOR_WHITE "-------------------------------------")
MESSAGE(COLOR_WHITE "-- BUILDING EXECUTABLES")
MESSAGE(COLOR_WHITE "-------------------------------------")
MESSAGE(COLOR_WHITE "")
#MESSAGE("${ORTHOKLAMPT_SRC}")
#MESSAGE("${ORTHOKLAMPT_LIB}")

FILE(GLOB EXECUTABLES_SOURCES test/*.cpp)
LIST(SORT EXECUTABLES_SOURCES)

SET(EXECUTABLES ${EXECUTABLES_SOURCES})
FOREACH(FILENAME ${EXECUTABLES})
  GET_FILENAME_COMPONENT( EXECUTABLE ${FILENAME} NAME_WE)
  MESSAGE(COLOR_WHITE "-- ${EXECUTABLE}")
  ADD_EXECUTABLE( ${EXECUTABLE} ${FILENAME} ${ORTHOKLAMPT_SRC})
  TARGET_LINK_LIBRARIES(${EXECUTABLE} ${ORTHOKLAMPT_LIBRARIES})
ENDFOREACH(FILENAME)
MESSAGE("-------------------------------------")

#SET( CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} -std=c++11 -g -Wall -Werror" )
SET( CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} -std=c++11 -g -Wall" )
