CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT( Orthoklampt )

set(ORTHOKLAMPT_MAJOR_VERSION 0)
set(ORTHOKLAMPT_MINOR_VERSION 1)
set(ORTHOKLAMPT_PATCH_VERSION 0)
set(ORTHOKLAMPT_VERSION ${ORTHOKLAMPT_MAJOR_VERSION}.${ORTHOKLAMPT_MINOR_VERSION}.${ORTHOKLAMPT_PATCH_VERSION})
MESSAGE("${CMAKE_MODULE_PATH}")
LIST(APPEND CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}/CMakeModules")
INCLUDE(CMakeColors)
set(CMAKE_CXX_COMPILER "g++-5")
#set(CMAKE_INSTALL_RPATH "${CMAKE_INSTALL_PREFIX}/lib")


###############################################################################
SET(KLAMPT_ROOT /home/aorthey/git/Klampt/)
###############################################################################

SET (CMAKE_MODULE_PATH "${KLAMPT_ROOT}/CMakeModules")

#SET(SBL_USE_LIBS ESBTL CGAL MPFR GMP Boost)
FIND_PACKAGE(CGAL REQUIRED)
INCLUDE( ${CGAL_USE_FILE} )
FIND_PACKAGE(Klampt REQUIRED) 
FIND_PACKAGE(OMPL REQUIRED)
FIND_PACKAGE(Boost 1.54.0 REQUIRED COMPONENTS system thread serialization)

cmake_policy(SET CMP0015 NEW)
SET(SBL_USE_LIBS ESBTL CGAL MPFR GMP Boost)
FIND_PACKAGE(SBL REQUIRED)
if ( SBL_FOUND )
  INCLUDE(${SBL_USE_FILE}) 
endif()



INCLUDE_DIRECTORIES("/usr/local/sbl/Core/Betti_numbers/include/")
ADD_DEFINITIONS(${KLAMPT_DEFINITIONS})

#SET(INCLUDE_DIRS ${KLAMPT_INCLUDE_DIRS} src/ src/planner/)
INCLUDE_DIRECTORIES(${KLAMPT_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${CGAL_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${SBL_DIR})
INCLUDE_DIRECTORIES(src)
INCLUDE_DIRECTORIES(src/planner)

FILE(GLOB ORTHOKLAMPT_SRC src/*.cpp src/planner/*.cpp src/elements/*.cpp src/controller/*.cpp)

SET(ORTHOKLAMPT_LIB ${KLAMPT_LIBRARIES} ${OMPL_LIBRARIES} ${Boost_LIBRARIES} ${SBL_COMMON_LIBS} ompl_app_base)

MESSAGE("OMPL   VERSION:  ${OMPL_VERSION}")
MESSAGE("CGAL   VERSION:  ${CGAL_VERSION}")
MESSAGE("BOOST  VERSION:  ${Boost_VERSION}")
MESSAGE("KLAMPT VERSION:  ${KLAMPT_VERSION}")
MESSAGE("SBL    VERSION:  ${SBL_VERSION}")
MESSAGE("LIBRARY INCLUDE: ${SBL_COMMON_LIBS}")
MESSAGE("INCLUDE INCLUDE: ${SBL_DIR}")
MESSAGE("-------------------------------------")
MESSAGE("LIBRARY INCLUDE: ${ORTHOKLAMPT_LIB}")
MESSAGE("-------------------------------------")
MESSAGE(COLOR_WHITE "BUILDING EXECUTABLES")
MESSAGE("-------------------------------------")
#MESSAGE("${ORTHOKLAMPT_SRC}")
#MESSAGE("${ORTHOKLAMPT_LIB}")

FILE(GLOB EXECUTABLES_SOURCES test/*.cpp)
LIST(SORT EXECUTABLES_SOURCES)

SET(EXECUTABLES ${EXECUTABLES_SOURCES})
FOREACH(FILENAME ${EXECUTABLES})
  GET_FILENAME_COMPONENT( EXECUTABLE ${FILENAME} NAME_WE)
  MESSAGE(COLOR_WHITE "-- ${EXECUTABLE}")
  ADD_EXECUTABLE( ${EXECUTABLE} ${FILENAME} ${ORTHOKLAMPT_SRC})
  TARGET_LINK_LIBRARIES(${EXECUTABLE} ${ORTHOKLAMPT_LIB})
ENDFOREACH(FILENAME)
MESSAGE("-------------------------------------")

SET( CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} -std=c++11 -g -Wall" )
